(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/pm/pmHome"],{"148e":function(e,t,a){"use strict";(function(e){a("e09c");n(a("66fd"));var t=n(a("2d2c"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("c11b")["createPage"])},"2d2c":function(e,t,a){"use strict";a.r(t);var n=a("5ae2"),o=a("73c3");for(var i in o)"default"!==i&&function(e){a.d(t,e,(function(){return o[e]}))}(i);a("e37d");var s,c=a("f0c5"),r=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=r.exports},5627:function(e,t,a){},"5ae2":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n}));var n={wechatUserInfo:function(){return a.e("components/wechatUserInfo/wechatUserInfo").then(a.bind(null,"9465"))}},o=function(){var e=this,t=e.$createElement;e._self._c},i=[]},"73c3":function(e,t,a){"use strict";a.r(t);var n=a("b196"),o=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=o.a},b196:function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a("3b7d"),o=a("aa5f"),i=getApp(),s=function(){a.e("components/icon/icon").then(function(){return resolve(a("c5a1"))}.bind(null,a)).catch(a.oe)},c=function(){a.e("components/avatar/avatar").then(function(){return resolve(a("1537"))}.bind(null,a)).catch(a.oe)},r=function(){a.e("components/wechatUserInfo/wechatUserInfo").then(function(){return resolve(a("9465"))}.bind(null,a)).catch(a.oe)},u=function(){a.e("components/halfSlideItem/halfSlideItem").then(function(){return resolve(a("933a"))}.bind(null,a)).catch(a.oe)},l=function(){a.e("components/sliderPicker/sliderPicker").then(function(){return resolve(a("3422"))}.bind(null,a)).catch(a.oe)},f={data:function(){return{items:[{icon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/seal_icon.png",name:"印章管理",hasAuth:!0},{icon:"/static/images/invoice/invoice_apply_icon.png",name:"发票申请",hasAuth:!0},{icon:"/static/images/invoice/invoice_apply_icon.png",name:"收款",hasAuth:!0}],sliderList:[{label:"销售模版发起收款",value:0},{label:"独立收款",value:1},{label:"取消",value:2}],isShowReceiptMethod:!1,isAdmin:!1,wechatUserInfoShow:!1,waitAffirmCount:0,unreadContractMessageCount:0,username:"",userPhone:"",userToken:"",userAvatar:"",isAuth:!1}},components:{icon:s,avatar:c,wechatUserInfo:r,halfSlideItem:u,sliderPicker:l},props:{},onLoad:function(t){var a=this;if(null!=t.navigateUrl){var n=t.navigateUrl.replace(":","?");n=n.replace("#","="),e.navigateTo({url:n})}my.getAuthCode({scopes:"auth_user",success:function(e){console.log(e,1111),my.getAuthUserInfo({success:function(e){console.log(e,222),a.setData({userAvatar:e.avatar,username:e.nickName}),i.globalData.userName=e.nickName,i.globalData.userAvatar=e.avatar}})}})},onShow:function(){var t=3==i.globalData.memberType;if(this.setData({isAdmin:t}),this.init(),i.globalData.isLoginIn()){var a=e.getStorageSync("currentUser"),n=this.items;(a.companyId&&a.roleTypes&&!a.roleTypes.includes("1")&&!a.roleTypes.includes("2")||a.companyId&&null==a.roleTypes||!i.globalData.isLoginIn())&&(n[1].hasAuth=!1),(a.companyId&&2!=a.payStatus||!a.companyId)&&(n[3].hasAuth=!1),this.setData({items:n})}else this.setData({items:[]})},onShareAppMessage:function(){},methods:{init:function(){this.setData({username:i.globalData.userName,userPhone:i.globalData.phone,userToken:i.globalData.userToken,isAuth:i.globalData.isAuth}),console.log(i.globalData,77777)},login:function(){e.redirectTo({url:"/pages/root/root"})},tapItem:function(t){if(!i.globalData.isLoginIn())return i.globalData.login(),!1;var a=t.currentTarget.dataset.index,n="";switch(a){case 0:n="/pages/pm/stamp/stampManager";break;case 1:n="/pages/costManage/costManage";break;case 2:n="/pages/invoice/invoice";break;case 3:this.selectReceipMathod();break;default:n="/pages/pm/project/projectList";break}3!=a&&e.navigateTo({url:n})},getUserInfo:function(){var t=this;e.getSetting({success:function(a){a.authSetting["scope.userInfo"]?e.getUserInfo({success:function(e){t.getWechatUserInfo({detail:e.userInfo})},fail:function(){t.setData({wechatUserInfoShow:!0})}}):t.setData({wechatUserInfoShow:!0})}})},getWechatUserInfo:function(e){this.setData({wechatUserInfoShow:!1}),(0,n.put)({url:o.update_usericon,params:{iconUrl:e.detail.avatarUrl,nickname:e.detail.nickName},success:function(){i.globalData.updateUserIcon(e.detail.avatarUrl)}})},authAction:function(){this.isAuth||e.navigateTo({url:"/pages/authentication/personal/personal-auth-type/index"})},selectReceipMathod:function(){this.$refs.sliderPicker.show()},handleSliderOperateFun:function(t){switch(t.detail){case 0:e.navigateTo({url:"/pages/collection/templateCollection/templateCollection?isTemplate=1"});break;case 1:e.navigateTo({url:"/pages/collection/dirctCollection/dirctCollection?isTemplate=0"});break;default:break}this.$refs.sliderPicker.hide()}}};t.default=f}).call(this,a("c11b")["default"])},e37d:function(e,t,a){"use strict";var n=a("5627"),o=a.n(n);o.a}},[["148e","common/runtime","common/vendor"]]]);