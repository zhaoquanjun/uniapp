(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/costManage/accountBalance/accountBalance"],{"0877":function(e,n,a){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=a("3b7d"),i=a("730f");function s(e){return u(e)||c(e)||r(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,n){if(e){if("string"===typeof e)return l(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?l(e,n):void 0}}function c(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function u(e){if(Array.isArray(e))return l(e)}function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var a=0,t=new Array(n);a<n;a++)t[a]=e[a];return t}var p={data:function(){return{tabs:[{name:"支出明细",type:1},{name:"收入明细",type:2},{name:"礼品卡",type:3}],activeName:1,payList:[],incomeList:[],useful:[],send:[],payTotal:0,incomeTotal:0,usefulTotal:0,sendTotal:0,payPagination:{pageIndex:1,pageSize:10},incomePagination:{pageIndex:1,pageSize:10},isRefresh:!1,origin:"",vipBg:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/vip_bg.png",shanqianBg:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/shanqian_bg.png",lawyerBg:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/lawyer_bg.png",overdueBg:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/overdue_bg.png",vipCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/vip_card.png",shanqianCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/shanqian_card.png",lawyerCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/lawyer_card.png",vipOverdueCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/vip_overdue_card.png",lawyerOverdueCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/lawyer_overdue_card.png",shanqianOverdueCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/shanqian_overdue_card.png",sendIcon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/send_icon.png",receiveIcon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/receive_icon.png",waitReceiveIcon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/wait_receive_icon.png",alreadyReceiveIcon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/already_receive_icon.png"}},components:{},props:{},onLoad:function(e){e.type&&this.setData({activeName:e.type}),e.result&&this.setData({origin:e.result}),this.getBalanceListFun()},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){this.origin&&e.redirectTo({url:"/pages/costManage/costManage"})},onPullDownRefresh:function(){if(1==this.activeName){var e=this.payPagination;e.pageIndex=1,this.setData({payPagination:e}),this.getBalanceListFun()}if(2==this.activeName){var n=this.incomePagination;n.pageIndex=1,this.setData({incomePagination:n}),this.getBalanceListFun()}3==this.activeName&&(this.getCardListDataFun(1,1),this.getCardListDataFun(2,1))},onReachBottom:function(){},onShareAppMessage:function(){},methods:{getBalanceListFun:function(){var n=this,a={consumptionDetailsType:this.activeName,pageSize:1==this.activeName?this.payPagination.pageSize:this.incomePagination.pageSize,currentPage:1==this.activeName?this.payPagination.pageIndex:this.incomePagination.pageIndex};e.showLoading({title:"加载中"}),(0,t.get)({url:i.get_balance_list,params:a,success:function(e){if(e.results.forEach((function(e){e.consumptionTime=n.formatTimeConvertFun(e.consumptionTime,0),e.consumptionMoney=(e.consumptionMoney/100).toFixed(2)})),1==n.activeName){var a=[].concat(s(n.payList),s(e.results));n.setData({payList:a,payTotal:e.total})}if(2==n.activeName){var t=[].concat(s(n.incomeList),s(e.results));n.setData({incomeList:t,incomeTotal:e.total})}},fail:function(e){console.log(e)},complete:function(){e.hideLoading(),n.isRefresh&&n.setData({isRefresh:!1})}})},handleScrollToBottmFun:function(){if(!this.isRefresh){if(1==this.activeName){if(this.payTotal==this.payList.length)return!1;var e=this.payPagination;e.pageIndex=this.payPagination.pageIndex+1,this.setData({isRefresh:!0,payPagination:e}),this.getBalanceListFun()}if(2==this.activeName){if(this.incomeTotal==this.incomeList.length)return!1;var n=this.incomePagination;n.pageIndex=this.incomePagination.pageIndex+1,this.setData({isRefresh:!0,incomePagination:n}),this.getBalanceListFun()}}},getCardListDataFun:function(n,a){var o=this;e.showLoading({title:"加载中"}),(0,t.get)({url:i.get_card_list+"?searchType="+n+"&currentPage="+a+"&pageSize=10000",success:function(e){switch(console.log(e),e.results.map((function(e){e.recipientTime=e.recipientTime?o.formatTimeConvertFun(e.recipientTime,0):"-",e.invalidTime=e.invalidTime?o.formatTimeConvertFun(e.invalidTime,0):"-",e.balance=(e.balance/100).toFixed(2),e.amount=(e.amount/100).toFixed(2)})),Number(n)){case 1:var t=s(JSON.parse(JSON.stringify(o.useful)));o.useful.length<e.total&&(o.setData({useful:[].concat(s(t),s(e.results)),usefulTotal:e.total}),o.useful.length<o.usefulTotal&&o.getCardListDataFun(1,Number(a)+1));break;case 2:var i=s(JSON.parse(JSON.stringify(o.send)));(!o.sendGet||o.send.length<e.total)&&(o.setData({send:[].concat(s(i),s(e.results)),sendTotal:e.total}),o.send.length<o.sendTotal&&o.getCardListDataFun(2,Number(a)+1));break;default:break}},fail:function(e){console.log(e)},complete:function(){e.hideLoading(),o.isRefresh&&o.setData({isRefresh:!1})}})},handleSwitchTabFun:function(e){var n=e.currentTarget.dataset.type;switch(this.setData({activeName:n}),n){case 1:this.getBalanceListFun();break;case 2:this.getBalanceListFun();break;case 3:this.getCardListDataFun(1,1),this.getCardListDataFun(2,1);break;default:break}},handleReadyToChargeFun:function(){e.navigateTo({url:"/pages/costManage/recharge/recharge"})},handleReadyToSendFun:function(){e.navigateTo({url:"/pages/costManage/buyCard/buyCard?type=1"})},handleSendFun:function(n){var a=n.currentTarget.dataset.item;e.navigateTo({url:"/pages/costManage/giveSettings/giveSettings?origin=card&id="+a.id+"&balance="+a.balance+"&type="+a.couponType+"&time="+a.invalidTime})},handleViewDetailFun:function(n){var a=n.currentTarget.dataset.item;e.navigateTo({url:"/pages/costManage/cardDetail/cardDetail?id="+a.id})},formatTimeConvertFun:function(e,n){e+="",e=10==e.length?1e3*e:e;var a=new Date(Number(e)),t=a.getFullYear(),i=a.getMonth()+1;i=i<10?"0"+i:i;var s=a.getDate();s=s<10?"0"+s:s;var o=a.getHours();o=o<10?"0"+o:o;var r=a.getMinutes(),c=a.getSeconds();return r=r<10?"0"+r:r,c=c<10?"0"+c:c,0==n?t+"-"+i+"-"+s:t+"-"+i+"-"+s+" "+o+":"+r+":"+c}}};n.default=p}).call(this,a("c11b")["default"])},"277b":function(e,n,a){},"3f4c":function(e,n,a){"use strict";(function(e){a("e09c");t(a("66fd"));var n=t(a("e7f9"));function t(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,a("c11b")["createPage"])},aa46:function(e,n,a){"use strict";a.r(n);var t=a("0877"),i=a.n(t);for(var s in t)"default"!==s&&function(e){a.d(n,e,(function(){return t[e]}))}(s);n["default"]=i.a},b279:function(e,n,a){"use strict";var t=a("277b"),i=a.n(t);i.a},e7f9:function(e,n,a){"use strict";a.r(n);var t=a("ea34"),i=a("aa46");for(var s in i)"default"!==s&&function(e){a.d(n,e,(function(){return i[e]}))}(s);a("b279");var o,r=a("f0c5"),c=Object(r["a"])(i["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],o);n["default"]=c.exports},ea34:function(e,n,a){"use strict";var t;a.d(n,"b",(function(){return i})),a.d(n,"c",(function(){return s})),a.d(n,"a",(function(){return t}));var i=function(){var e=this,n=e.$createElement;e._self._c},s=[]}},[["3f4c","common/runtime","common/vendor"]]]);