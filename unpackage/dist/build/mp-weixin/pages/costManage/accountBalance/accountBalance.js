(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/costManage/accountBalance/accountBalance"],{"0877":function(e,a,n){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var t=n("3b7d"),i=n("730f");function s(e){return u(e)||c(e)||r(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,a){if(e){if("string"===typeof e)return l(e,a);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,a):void 0}}function c(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function u(e){if(Array.isArray(e))return l(e)}function l(e,a){(null==a||a>e.length)&&(a=e.length);for(var n=0,t=new Array(a);n<a;n++)t[n]=e[n];return t}var p={data:function(){return{tabs:[{name:"支出明细",type:1},{name:"收入明细",type:2},{name:"礼品卡",type:3}],activeName:1,payList:[],incomeList:[],useful:[],send:[],payTotal:0,incomeTotal:0,usefulTotal:0,sendTotal:0,payPagination:{pageIndex:1,pageSize:10},incomePagination:{pageIndex:1,pageSize:10},isRefresh:!1,origin:"",vipBg:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/vip_bg.png",shanqianBg:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/shanqian_bg.png",lawyerBg:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/lawyer_bg.png",overdueBg:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/overdue_bg.png",vipCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/vip_card.png",shanqianCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/shanqian_card.png",lawyerCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/lawyer_card.png",vipOverdueCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/vip_overdue_card.png",lawyerOverdueCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/lawyer_overdue_card.png",shanqianOverdueCard:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/shanqian_overdue_card.png",sendIcon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/send_icon.png",receiveIcon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/receive_icon.png",waitReceiveIcon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/wait_receive_icon.png",alreadyReceiveIcon:"https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/cost/already_receive_icon.png"}},components:{},props:{},onLoad:function(e){e.type&&this.setData({activeName:e.type}),e.result&&this.setData({origin:e.result}),this.getBalanceListFun()},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){this.origin&&e.redirectTo({url:"/pages/costManage/costManage"})},onPullDownRefresh:function(){if(1==this.activeName){var e=this.payPagination;e.pageIndex=1,this.setData({payPagination:e}),this.getBalanceListFun()}if(2==this.activeName){var a=this.incomePagination;a.pageIndex=1,this.setData({incomePagination:a}),this.getBalanceListFun()}3==this.activeName&&(this.getCardListDataFun(1,1),this.getCardListDataFun(2,1))},onReachBottom:function(){},onShareAppMessage:function(){},methods:{getBalanceListFun:function(){var a=this,n={consumptionDetailsType:this.activeName,pageSize:1==this.activeName?this.payPagination.pageSize:this.incomePagination.pageSize,currentPage:1==this.activeName?this.payPagination.pageIndex:this.incomePagination.pageIndex};e.showLoading({title:"加载中"}),(0,t.get)({url:i.get_balance_list,params:n,success:function(e){if(e.results.forEach((function(e){e.consumptionTime=a.formatTimeConvertFun(e.consumptionTime,0),e.consumptionMoney=(e.consumptionMoney/100).toFixed(2)})),1==a.activeName){var n=[].concat(s(a.payList),s(e.results));a.setData({payList:n,payTotal:e.total})}if(2==a.activeName){var t=[].concat(s(a.incomeList),s(e.results));a.setData({incomeList:t,incomeTotal:e.total})}},fail:function(e){console.log(e)},complete:function(){e.hideLoading(),a.isRefresh&&a.setData({isRefresh:!1})}})},handleScrollToBottmFun:function(){if(!this.isRefresh){if(1==this.activeName){if(this.payTotal==this.payList.length)return!1;var e=this.payPagination;e.pageIndex=this.payPagination.pageIndex+1,this.setData({isRefresh:!0,payPagination:e}),this.getBalanceListFun()}if(2==this.activeName){if(this.incomeTotal==this.incomeList.length)return!1;var a=this.incomePagination;a.pageIndex=this.incomePagination.pageIndex+1,this.setData({isRefresh:!0,incomePagination:a}),this.getBalanceListFun()}}},getCardListDataFun:function(a,n){var o=this;e.showLoading({title:"加载中"}),(0,t.get)({url:i.get_card_list+"?searchType="+a+"&currentPage="+n+"&pageSize=10000",success:function(e){switch(console.log(e),e.results.map((function(e){e.recipientTime=e.recipientTime?o.formatTimeConvertFun(e.recipientTime,0):"-",e.invalidTime=e.invalidTime?o.formatTimeConvertFun(e.invalidTime,0):"-",e.balance=(e.balance/100).toFixed(2),e.amount=(e.amount/100).toFixed(2)})),Number(a)){case 1:var t=s(JSON.parse(JSON.stringify(o.useful)));o.useful.length<e.total&&(o.setData({useful:[].concat(s(t),s(e.results)),usefulTotal:e.total}),o.useful.length<o.usefulTotal&&o.getCardListDataFun(1,Number(n)+1));break;case 2:var i=s(JSON.parse(JSON.stringify(o.send)));(!o.sendGet||o.send.length<e.total)&&(o.setData({send:[].concat(s(i),s(e.results)),sendTotal:e.total}),o.send.length<o.sendTotal&&o.getCardListDataFun(2,Number(n)+1));break;default:break}},fail:function(e){console.log(e)},complete:function(){e.hideLoading(),o.isRefresh&&o.setData({isRefresh:!1})}})},handleSwitchTabFun:function(e){var a=e.currentTarget.dataset.type;switch(this.setData({activeName:a}),a){case 1:this.getBalanceListFun();break;case 2:this.getBalanceListFun();break;case 3:this.getCardListDataFun(1,1),this.getCardListDataFun(2,1);break;default:break}},handleReadyToChargeFun:function(){e.navigateTo({url:"/pages/costManage/recharge/recharge"})},handleReadyToSendFun:function(){e.navigateTo({url:"/pages/costManage/buyCard/buyCard?type=1"})},handleSendFun:function(a){var n=a.currentTarget.dataset.item;e.navigateTo({url:"/pages/costManage/giveSettings/giveSettings?origin=card&id="+n.id+"&balance="+n.balance+"&type="+n.couponType+"&time="+n.invalidTime})},handleViewDetailFun:function(a){var n=a.currentTarget.dataset.item;e.navigateTo({url:"/pages/costManage/cardDetail/cardDetail?id="+n.id})},formatTimeConvertFun:function(e,a){e+="",e=10==e.length?1e3*e:e;var n=new Date(Number(e)),t=n.getFullYear(),i=n.getMonth()+1;i=i<10?"0"+i:i;var s=n.getDate();s=s<10?"0"+s:s;var o=n.getHours();o=o<10?"0"+o:o;var r=n.getMinutes(),c=n.getSeconds();return r=r<10?"0"+r:r,c=c<10?"0"+c:c,0==a?t+"-"+i+"-"+s:t+"-"+i+"-"+s+" "+o+":"+r+":"+c}}};a.default=p}).call(this,n("543d")["default"])},"277b":function(e,a,n){},"3f4c":function(e,a,n){"use strict";(function(e){n("e09c");t(n("66fd"));var a=t(n("e7f9"));function t(e){return e&&e.__esModule?e:{default:e}}e(a.default)}).call(this,n("543d")["createPage"])},aa46:function(e,a,n){"use strict";n.r(a);var t=n("0877"),i=n.n(t);for(var s in t)"default"!==s&&function(e){n.d(a,e,(function(){return t[e]}))}(s);a["default"]=i.a},b279:function(e,a,n){"use strict";var t=n("277b"),i=n.n(t);i.a},da52:function(e,a,n){"use strict";var t;n.d(a,"b",(function(){return i})),n.d(a,"c",(function(){return s})),n.d(a,"a",(function(){return t}));var i=function(){var e=this,a=e.$createElement;e._self._c},s=[]},e7f9:function(e,a,n){"use strict";n.r(a);var t=n("da52"),i=n("aa46");for(var s in i)"default"!==s&&function(e){n.d(a,e,(function(){return i[e]}))}(s);n("b279");var o,r=n("f0c5"),c=Object(r["a"])(i["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],o);a["default"]=c.exports}},[["3f4c","common/runtime","common/vendor"]]]);