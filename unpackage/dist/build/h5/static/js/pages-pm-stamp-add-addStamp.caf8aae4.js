(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-pm-stamp-add-addStamp"],{"0287":function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,"/* pages/pm/stamp/add/addStamp.wxss */.stamp-canvas[data-v-665ef351]{position:fixed;top:0;left:%?98?%;display:block;width:%?652?%;height:100%;background-color:#f7f8f9}.copy-canvas[data-v-665ef351]{left:-200%}.watermark[data-v-665ef351]{width:%?768?%;height:%?178?%;-webkit-transform:rotate(90deg);transform:rotate(90deg);-webkit-transform-origin:0 0;transform-origin:0 0;position:relative;margin-top:%?200?%;margin-left:60%}.operation-btn-view[data-v-665ef351]{position:fixed;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-content:flex-start;align-content:flex-start;-webkit-flex-wrap:wrap;flex-wrap:wrap;padding:%?70?% %?8?%;width:%?97?%;height:100%;background-color:#fff;box-sizing:border-box}.pen-btn[data-v-665ef351]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin-top:%?30?%;padding:%?10?%;width:%?48?%;height:%?48?%;border-radius:50%;border:%?4?% solid transparent;background:#fff}.pen-btn .one[data-v-665ef351]{width:%?36?%;height:%?36?%;color:transparent;border-radius:50%}.pen-size-container[data-v-665ef351]{position:absolute;right:%?-200?%;top:%?360?%;background:#fff;-webkit-transform:rotate(90deg);transform:rotate(90deg);width:136px;line-height:%?43?%;height:43px;background:#fff;border-radius:4px}.pen-size-container .one[data-v-665ef351]{position:inherit}.line[data-v-665ef351]{border-right:1px solid #e5e5e5;float:left;width:%?2?%;height:%?40?%;margin-top:%?30?%;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.pen-btn.active[data-v-665ef351]{border:%?4?% solid #dfdfdf;position:relative;background-color:#fff;box-shadow:%?0?% %?4?% %?8?% %?0?% hsla(0,0%,61.6%,.5)}.pen-btn.active-pen[data-v-665ef351]{border:%?4?% solid #dfdfdf;background:#f8f8f8;box-shadow:%?0?% %?4?% %?8?% %?0?% hsla(0,0%,61.6%,.5)}.pen-text[data-v-665ef351]{width:%?60?%;height:%?60?%;font-size:%?28?%;font-weight:200;line-height:%?60?%;color:#fff}.first-pen-btn[data-v-665ef351]{margin-top:0}.clean-btn[data-v-665ef351]{position:fixed;bottom:%?246?%;background-color:#f5f5f5;-webkit-transform:rotate(90deg);transform:rotate(90deg);text-align:center;width:%?126?%;height:%?60?%;line-height:%?50?%;border-radius:%?30?%}.clean-text[data-v-665ef351]{width:%?126?%;height:%?60?%;font-size:%?28?%;font-weight:200;line-height:%?60?%;color:#000}.submit-btn[data-v-665ef351]{position:fixed;bottom:%?100?%;-webkit-transform:rotate(90deg);transform:rotate(90deg);text-align:center;width:%?126?%;height:%?60?%;line-height:%?50?%;background:#464646;border-radius:%?30?%}.submit-text[data-v-665ef351]{width:%?126?%;height:%?60?%;line-height:%?50?%;font-size:%?28?%;font-weight:200;line-height:%?60?%;color:#fff}",""]),t.exports=e},"03db":function(t,e,a){"use strict";a.r(e);var n=a("7794"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},1259:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.save_personnal_seal=e.upload_painted_wx_url=e.delete_painted_url=e.set_default_seal=e.company_painted_list=e.person_painted_list=e.upload_person_seal=e.upload_company_seal=e.create_seal=void 0;var n=a("3b7d"),i=n.host+"/v1/pass/uploadImgByBase64String";e.create_seal=i;var o=n.host+"/v1/file/saveCompanySeal";e.upload_company_seal=o;var s=n.host+"/v1/file/savePersonalSeal";e.upload_person_seal=s;var r=n.host+"/v1/file/getPersonalSealList";e.person_painted_list=r;var c=n.host+"/v1/file/getEnterpriseSealList";e.company_painted_list=c;var l=n.host+"/v1/file/painted/default";e.set_default_seal=l;var d=n.host+"/v1/file/handleSignImageStatus";e.delete_painted_url=d;var p=n.host+"/v1/pass/uploadFile";e.upload_painted_wx_url=p;var f=n.host+"/v1/file/savePersonalSeal";e.save_personnal_seal=f,t.exports.create_company_cachet_url=n.host+"/v1/file/create/cachet"},"1e8c":function(t,e,a){var n=a("0287");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("b0d24e1c",n,!0,{sourceMap:!1,shadowMode:!1})},"2bea":function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-canvas",{staticClass:"stamp-canvas",attrs:{"canvas-id":"stampCanvas",id:"stampCanvas","disable-scroll":"false"},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.touchStart.apply(void 0,arguments)},touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.touchMove.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"watermark",attrs:{src:"/static/pages/pm/stamp/add/watermark.png"}})],1),a("v-uni-canvas",{staticClass:"stamp-canvas copy-canvas",staticStyle:{"z-index":"-11",opacity:"0",visiblity:"hidden"},attrs:{"canvas-id":"myCanvas",id:"myCanvas"}}),a("v-uni-view",{staticClass:"operation-btn-view"},[a("v-uni-view",{class:"first-pen-btn pen-btn "+("#000"===t.color?"active":"")+"}",attrs:{"data-color":"#000"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.switchColor.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"one one-dot",staticStyle:{"background-color":"#000"}})],1),a("v-uni-view",{class:"pen-btn "+("#22ACF8"===t.color?"active":""),attrs:{"data-color":"#22ACF8"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.switchColor.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"one one-dot",staticStyle:{"background-color":"#22ACF8"}})],1),a("v-uni-view",{class:"pen-btn "+("#FE4E51"===t.color?"active":""),attrs:{"data-color":"#FE4E51"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.switchColor.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"one one-dot",staticStyle:{"background-color":"#FE4E51"}})],1),a("v-uni-view",{staticClass:"line"}),a("v-uni-image",{class:"pen-btn pen-size "+("4"==t.pen?"active-pen":""),attrs:{src:"/static/pages/pm/stamp/add/pen.png","data-pen":"4"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.switchPen.apply(void 0,arguments)}}}),a("v-uni-image",{class:"pen-btn pen-size "+("6"==t.pen?"active-pen":""),attrs:{src:"/static/pages/pm/stamp/add/pen1.png","data-pen":"6"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.switchPen.apply(void 0,arguments)}}}),a("v-uni-image",{class:"pen-btn pen-size "+("8"==t.pen?"active-pen":""),attrs:{src:"/static/pages/pm/stamp/add/pen2.png","data-pen":"8"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.switchPen.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"clean-btn",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.clearAction.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"clean-text"},[t._v("清除")])],1),a("v-uni-view",{staticClass:"submit-btn",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.submitAction.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"submit-text"},[t._v("提交")])],1)],1)],1)},o=[]},"2e3f":function(t,e,a){"use strict";var n=a("1e8c"),i=a.n(n);i.a},"4b45":function(t,e,a){"use strict";a.r(e);var n=a("2bea"),i=a("03db");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("2e3f");var s,r=a("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"665ef351",null,!1,n["a"],s);e["default"]=c.exports},7794:function(t,e,a){"use strict";a("ac1f"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a("3b7d"),i=a("1259"),o=getApp(),s={data:function(){return{stampUrl:"",color:"#000",pen:"4",penSizeShow:!1}},components:{},props:{},onShow:function(){setTimeout((function(){uni.showToast({icon:"none",title:"请将手机横屏"})}),50)},onLoad:function(t){},onShareAppMessage:function(){},methods:{canvasIdErrorCallback:function(t){console.error("canvas error:"+t.detail.errMsg)},touchStart:function(t){this.startX=t.changedTouches[0].x,this.startY=t.changedTouches[0].y,this.context=uni.createCanvasContext("stampCanvas"),this.context.setStrokeStyle(this.color),this.context.setLineWidth(this.pen),this.context.setLineCap("round"),this.context.beginPath()},touchMove:function(t){var e=t.changedTouches[0].x,a=t.changedTouches[0].y;this.context.moveTo(this.startX,this.startY),this.context.lineTo(e,a),this.context.stroke(),this.startX=e,this.startY=a,this.context.draw(!0)},switchPen:function(t){console.log("切换font");var e=t.currentTarget.dataset.pen;this.setData({pen:e})},switchColor:function(t){console.log("切换color");var e=t.currentTarget.dataset.color;this.setData({color:e})},clearAction:function(){console.log("清除"),this.context.clearRect(0,0,750,1334),this.context.draw()},submitAction:function(){var t=uni.createSelectorQuery();t.select("#stampCanvas").boundingClientRect((function(t){var e=t.width,a=t.height;uni.canvasToTempFilePath({canvasId:"stampCanvas",x:0,y:0,width:e,height:a,success:function(t){var s=t.tempFilePath;console.log(s);var r=uni.createCanvasContext("myCanvas");r.fillStyle="#fff",r.fillRect(0,0,e,a);var c=e/a;r.rotate(-90*Math.PI/180),r.scale(c,c),r.translate(1.5*-e,0),r.drawImage(s,0,0,e,a),r.draw(!0,(function(){uni.canvasToTempFilePath({canvasId:"myCanvas",x:0,y:0,width:a,height:e,success:function(t){uni.showLoading({title:"",mask:!0}),(0,n.upload)({url:i.upload_painted_wx_url,filePath:t.tempFilePath,key:"file",success:function(t){console.log(t);var e=o.globalData.getUserToken(),a={token:e,"Content-Type":"application/json"};(0,n.postBody)({url:i.save_personnal_seal,header:a,params:{name:"印章",url:t.url,originType:1},success:function(t){console.log(t),uni.hideLoading(),uni.navigateBack({delta:getCurrentPages.length-1})},fail:function(t){uni.hideLoading(),uni.navigateBack({delta:getCurrentPages.length-1})}})},fail:function(t){console.log(t),uni.hideLoading()}})}})}))},fail:function(t){console.log(t)}})})).exec()}}};e.default=s}}]);