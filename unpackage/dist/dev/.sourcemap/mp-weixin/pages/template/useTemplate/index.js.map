{"version":3,"sources":["uni-app:///main.js","webpack:////Users/icourt/Desktop/code/wxApp/pages/template/useTemplate/index.vue?ba56","webpack:////Users/icourt/Desktop/code/wxApp/pages/template/useTemplate/index.vue?b400","webpack:////Users/icourt/Desktop/code/wxApp/pages/template/useTemplate/index.vue?4063","webpack:////Users/icourt/Desktop/code/wxApp/pages/template/useTemplate/index.vue?88dc","uni-app:///pages/template/useTemplate/index.vue","webpack:////Users/icourt/Desktop/code/wxApp/pages/template/useTemplate/index.vue?5c11","webpack:////Users/icourt/Desktop/code/wxApp/pages/template/useTemplate/index.vue?0c46"],"names":["createPage","Page"],"mappings":"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","file":"pages/template/useTemplate/index.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/template/useTemplate/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=32242470&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/template/useTemplate/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=32242470&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n<view class=\"use-template--page\">\n  <view class=\"title\">合同主题</view>\n  <view class=\"input-area\">\n    <input type=\"text\" maxlength=\"100\" :value=\"templateData.name\" @input=\"handleChangeContractTitleFun\"></input>\n    <text class=\"delete one one-close\" ontap=\"_handleClearContractTitle\"></text>\n  </view>\n  <view class=\"title\">合同文件</view>\n  <view class=\"file-list\">\n    <view v-for=\"(item, index) in fileList\" :key=\"index\" class=\"file-item\" :data-item=\"item\" @tap.stop=\"_handlePreviewFile\">\n      <view class=\"l-wrapper\">\n        <view class=\"icon\">\n          <image :src=\"fileIcon\" mode=\"aspectFit\"></image>\n        </view>\n        <view class=\"name\">{{item.fileName}}</view>\n      </view>\n      <text class=\"one one-apparrow-right arrow\"></text>\n    </view>\n  </view>\n  <view class=\"title\">合同附件</view>\n  <view class=\"file-list\">\n    <view v-for=\"(item, index) in attachment\" :key=\"index\" class=\"file-item\" :data-item=\"item\" @tap.stop=\"_handlePreviewFile\">\n      <view class=\"l-wrapper\">\n        <view class=\"icon\">\n          <image :src=\"fileIcon\" mode=\"aspectFit\"></image>\n        </view>\n        <view class=\"name\">{{item.fileName}}</view>\n      </view>\n      <text class=\"one one-apparrow-right arrow\"></text>\n    </view>\n  </view>\n  <view class=\"title\">参与方</view>\n  <view class=\"sign-list\">\n    <view v-for=\"(item, index) in templateData.templateSigns\" :key=\"index\" class=\"sign-item\">\n      <view class=\"user-info\">\n        <view class=\"info\">\n          <view class=\"name-auth\">\n            <view class=\"name\">{{item.relationType == 2 ? (item.companyName ? item.companyName : '待填写') : item.relationType == 1 ? (item.userName ? item.userName : '待填写') : '待填写'}}</view>\n            <view :class=\"'auth-status ' + ((item.relationType == 2 && item.companyAuthStatus) || (item.relationType == 1 && item.personAuthStatus) ? 'authed' : 'unauth')\">{{(item.relationType == 2 && item.companyAuthStatus) || (item.relationType == 1 && item.personAuthStatus) ? '已认证' : '未认证'}}</view>\n          </view>\n          <view class=\"phone-auth\">\n            <view class=\"phone\"><text v-if=\"item.relationType == 2\">{{item.userName ? item.userName : '待填写'}}</text> {{item.userPhone ? item.userPhone : ''}}</view><view :class=\"'auth-status ' + (item.personAuthStatus ? 'authed' : 'unauth')\" v-if=\"(item.userName && item.relationType == 2)\">{{item.personAuthStatus ? '已认证' : '未认证'}}</view>\n          </view>\n          <view class=\"seals\">{{item.sealWords}}</view>\n        </view>\n        <view class=\"edit\" v-if=\"item.templateUserType == 2\" :data-item=\"item\" :data-index=\"index\" ontap=\"_handleEditItem\">\n          <text>编辑</text><text class=\"one one-apparrow-right arrow\"></text>\n        </view>\n      </view>\n      <view class=\"order\">\n        <view class=\"sub-title\">参与顺序</view>\n        <view class=\"order-detail\">\n          <view class=\"fill item\" v-if=\"item.hasFill && item.fillOrder > -1\">\n            填写\n            <text class=\"order-words\">{{item.fillOrder + 1}}</text>\n          </view>\n          <view class=\"sign item\" v-if=\"item.hasSign && item.signOrder > -1\">\n            签署\n            <text class=\"order-words\">{{item.signOrder + 1}}</text>\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n  <view class=\"title\">抄送方</view>\n  <view class=\"add-cc\">\n    <view class=\"add-btn\" ontap=\"_handleAddCompany\">\n      <image class=\"addSign\" mode=\"aspectFit\" :src=\"addIcon\"></image>\n      添加企业\n    </view>\n    <view class=\"add-btn\" ontap=\"_handleAddPerson\">\n      <image class=\"addSign\" mode=\"aspectFit\" :src=\"addIcon\"></image>\n      添加个人\n    </view>\n  </view>\n  <view class=\"cc-list\">\n    <view v-for=\"(item, index) in templateData.templateCcs\" :key=\"index\" class=\"cc-item\">\n      <view class=\"name-auth\">\n        <view class=\"name\">{{item.relationType == 2 ? item.companyName : item.userName}}</view>\n        <!-- <view class=\"auth-status {{(item.relationType == 2 && item.companyAuthStatus) || (item.relationType == 1 && item.personAuthStatus) ? 'authed' : 'unauth'}}\">{{(item.relationType == 2 && item.companyAuthStatus) || (item.relationType == 1 && item.personAuthStatus) ? '已认证' : '未认证'}}</view> -->\n      </view>\n      <view class=\"phone\"><text v-if=\"item.relationType == 2\">{{item.userName}}</text> {{item.userPhone}}</view>\n      <text class=\"delete one one-close\" v-if=\"item.isNew\" :data-index=\"index\" ontap=\"_handleDeleteCcs\"></text>\n    </view>\n  </view>\n  <view class=\"title\">其他设置</view>\n  <view class=\"other-setting\">\n    <view class=\"setting-item\">\n      <text class=\"sub-title\">签署截止时间</text>\n      <view class=\"date-picker\">\n        <picker mode=\"date\" :value=\"date\" start=\"2019-10-01\" end data-type=\"file\" @change=\"handleSelectDateFun\">\n          <view class=\"pickDate\">\n            <input type=\"date\" disabled=\"true\" name=\"addtime\" :value=\"signEndTime\" placeholder=\"请选择\"></input>\n          </view>\n        </picker>\n        <text class=\"one one-apparrow-right\"></text>\n      </view>\n    </view>\n    <view class=\"setting-item\">\n      <text class=\"sub-title\">合同终止时间</text>\n      <view class=\"date-picker\">\n        <picker mode=\"date\" :value=\"date\" start=\"2019-10-01\" end data-type=\"file\" @change=\"handleSelectDateFun\">\n          <view class=\"pickDate\">\n            <input type=\"date\" disabled=\"true\" name=\"addtime\" :value=\"fileEndTime\" placeholder=\"请选择\"></input>\n          </view>\n        </picker>\n        <text class=\"one one-apparrow-right\"></text>\n      </view>\n    </view>\n  </view>\n  <view class=\"launch-btn\" ontap=\"_handleLaunchConfirm\">发起签署</view>\n</view>\r\n</template>\r\n\r\n<script>\r\n// pages/template/useTemplate/index.js\nconst api = require(\"../../../api/request\");\r\nconst util = require(\"../../../utils/utils\");\r\n\r\nexport default {\n  data() {\n    return {\n      addIcon: 'https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/contract/addsign.png',\n      fileIcon: \"/static/images/template/file_icon.png\",\n      templateData: null,\n      fileList: [{\n        name: '12312321'\n      }],\n      // 文件列表\n      attachment: [],\n      // 附件列表\n      signEndTime: '',\n      fileEndTime: '',\n      id: '',\n      // 模版id\n      origin: '',\n      //来源\n      operate: '' // 当前操作类\n      ,\n      index: \"\"\n    };\n  },\n\n  components: {},\n  props: {},\n\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad: function (options) {\n    const id = options.id;\n    let arr = [];\n    this.setData({\n      id: id,\n      origin: options.origin || '',\n      operate: options.operate || '',\n      index: options.index || -1\n    });\n\n    if (options.origin == 'person') {\n      arr.push({\n        userName: options.name,\n        userPhone: options.phone,\n        isNew: true,\n        relationType: 1,\n        personAuthStatus: options.personAuthStatus || -1\n      });\n    }\n\n    if (options.origin == 'company') {\n      arr.push({\n        companyName: options.companyName,\n        userName: options.name,\n        userPhone: options.phone,\n        isNew: true,\n        relationType: 2,\n        personAuthStatus: options.personAuthStatus || -1,\n        companyAuthStatus: options.companyAuthStatus || -1\n      });\n    }\n\n    this.getTemplateDetailFun(arr);\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady: function () {},\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow: function () {},\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide: function () {},\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload: function () {},\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh: function () {},\n\n  /**\n   * 页面上拉触底事件的处理函数\n   */\n  onReachBottom: function () {},\n\n  /**\n   * 用户点击右上角分享\n   */\n  onShareAppMessage: function () {},\n  methods: {\n    /**\n     * @name 获取模版详情\n     */\n    getTemplateDetailFun(newArr) {\n      uni.showLoading({\n        title: '加载中'\n      });\n      api.sendGet({\n        url: api.get_template_detail + '?contractTemplateId=' + this.id,\n        success: res => {\n          console.log(res);\n          res.templateSigns.forEach(it => {\n            // 处理印章类型展示 - 转化为文字 - 汉字\n            it.sealWords = this.conversionSealsFun(it.sealTypes);\n\n            if (it.templateUserType == 1) {\n              const currentUser = uni.getStorageSync('currentUser');\n              const userName = uni.getStorageSync('userName');\n              const userPhone = uni.getStorageSync('userAccount');\n              it.companyName = currentUser.companyName;\n              it.userName = userName;\n              it.userPhone = userPhone;\n            }\n          }); // 拿到缓存的所有抄送方\n\n          if (this.origin) {\n            let ccs = uni.getStorageSync('templateCcs');\n            let signs = uni.getStorageSync('templateSigns'); // 新增抄送方\n\n            this.operate == 'add' && ccs.push(newArr[0]);\n            res.templateCcs = ccs; // 编辑参与方\n\n            if (this.operate == 'edit') {\n              signs[this.index].userName = newArr[0].userName;\n              signs[this.index].userPhone = newArr[0].userPhone;\n              signs[this.index].personAuthStatus = newArr[0].personAuthStatus;\n\n              if (this.origin == 'company') {\n                signs[this.index].companyName = newArr[0].companyName;\n                signs[this.index].companyAuthStatus = newArr[0].companyAuthStatus;\n              }\n            }\n\n            res.templateSigns = signs;\n          }\n\n          uni.setStorageSync('templateCcs', res.templateCcs);\n          uni.setStorageSync('templateSigns', res.templateSigns);\n          this.setData({\n            templateData: res,\n            fileList: res.contractTemplateFiles.filter(it => it.attachment == 0),\n            attachment: res.contractTemplateFiles.filter(it => it.attachment == 1)\n          });\n        },\n        fail: err => {\n          setTimeout(() => {\n            uni.showToast({\n              icon: 'none',\n              title: err\n            });\n          }, 50);\n        },\n        complete: () => {\n          uni.hideLoading();\n        }\n      });\n    },\n\n    /**\n     * @name 修改合同主题\n     */\n    handleChangeContractTitleFun(e) {\n      let templateData = this.templateData;\n      templateData.name = e.detail.value;\n      this.setData({\n        templateData: templateData\n      });\n    },\n\n    /**\n     * @name 清空合同主题\n     */\n    handleClearContractTitleFun() {\n      let templateData = this.templateData;\n      templateData.name = '';\n      this.setData({\n        templateData: templateData\n      });\n    },\n\n    /**\n     * @name 选择日期\n     */\n    handleSelectDateFun(e) {\n      const type = e.currentTarget.dataset.type;\n\n      switch (type) {\n        case 'file':\n          this.setData({\n            fileEndTime: e.detail.value\n          });\n          break;\n\n        case 'sign':\n          this.setData({\n            signEndTime: e.detail.value\n          });\n          break;\n\n        default:\n          break;\n      }\n    },\n\n    /**\n     * @name 转化印章类型为文字\n     */\n    conversionSealsFun(arr) {\n      let str = '';\n      arr.forEach(it => {\n        switch (it) {\n          case '1':\n            str += '手绘章,';\n            break;\n\n          case '2':\n            str += '企业章,';\n            break;\n\n          case '3':\n            str += '法人代表章,';\n            break;\n\n          case '4':\n            str += '模版章,';\n            break;\n\n          default:\n            break;\n        }\n      });\n      str = str.slice(0, str.length - 1);\n      return str;\n    },\n\n    /**\n     * @name 删除抄送房\n     */\n    handleDeleteCcsFun(e) {\n      let templateData = this.templateData;\n      templateData.templateCcs.splice(e.currentTarget.dataset.index, 1);\n      this.setData({\n        templateData: templateData\n      });\n    },\n\n    /**\n     * @name 抄送增加企业\n     */\n    handleAddCompanyFun() {\n      uni.navigateTo({\n        url: '/pages/template/addCompany/index?id=' + this.id\n      });\n    },\n\n    /**\n     * @name 抄送增加个人\n     */\n    handleAddPersonFun() {\n      uni.navigateTo({\n        url: '/pages/template/addPerson/index?id=' + this.id\n      });\n    },\n\n    /**\n     * @name 编辑参与方\n     */\n    handleEditItemFun(e) {\n      const item = e.currentTarget.dataset.item;\n      const index = e.currentTarget.dataset.index;\n      let url = '/pages/template';\n\n      if (item.relationType == 1) {\n        url += '/addPerson/index?index=' + index + '&id=' + this.id + '&name=' + (item.userName ? item.userName : '') + '&phone=' + (item.userPhone ? item.userPhone : '');\n      }\n\n      if (item.relationType == 2) {\n        url += '/addCompany/index?index=' + index + '&id=' + this.id + '&name=' + (item.userName ? item.userName : '') + '&phone=' + (item.userPhone ? item.userPhone : '') + '&companyName=' + (item.companyName ? item.companyName : '');\n      }\n\n      uni.navigateTo({\n        url: url\n      });\n    },\n\n    /**\n     * @name 预览文件\n     */\n    handlePreviewFileFun(e) {\n      const item = e.currentTarget.dataset.item;\n      uni.navigateTo({\n        url: '/pages/template/preview/index?templateId=' + this.id + '&id=' + item.id\n      });\n    },\n\n    /**\n     * @name 发起合同签署\n     */\n    handleLaunchConfirmFun() {\n      if (!this.checkSubmitInfosFun()) return;\n      let signs = [],\n          fills = [];\n      this.templateData.templateSigns.forEach(it => {\n        if (it.hasSign) {\n          let newSign = JSON.parse(JSON.stringify(it));\n          newSign.id = it.signId;\n          signs.push(newSign);\n        }\n\n        if (it.hasFill) {\n          let newFill = JSON.parse(JSON.stringify(it));\n          newFill.id = it.fillId;\n          fills.push(newFill);\n        }\n      });\n      let saveParams = {\n        createTime: this.templateData.createTime,\n        fileTermination: this.fileEndTime,\n        id: this.templateData.id,\n        modifyTime: this.templateData.modifyTime,\n        relationId: this.templateData.relationId,\n        relationType: this.templateData.relationType,\n        signingDeadline: this.signEndTime,\n        status: this.templateData.status,\n        name: this.templateData.name,\n        userOrder: this.templateData.userOrder,\n        contractTemplateFiles: this.templateData.contractTemplateFiles,\n        templateCcs: this.templateData.templateCcs,\n        templateFillers: fills,\n        templateSigners: signs,\n        contractSigners: signs\n      };\n      uni.showLoading({\n        title: '发起中'\n      });\n      api.sendPostBody({\n        url: api.confirm_contract_launch_by_template,\n        params: saveParams,\n        success: res => {\n          setTimeout(() => {\n            uni.showToast({\n              icon: 'none',\n              title: '合同发起成功'\n            });\n          }, 50);\n          let url = '';\n\n          if (fills.length > 0) {\n            url = '/pages/home/fill/fill?contractId=' + res;\n          } else {\n            url = '/pages/home/sign/next/signConfirm/signConfirm?contractId=' + res;\n          }\n\n          setTimeout(() => {\n            uni.redirectTo({\n              url: url\n            });\n          }, 1500);\n        },\n        fail: err => {\n          setTimeout(() => {\n            uni.showToast({\n              icon: 'none',\n              title: err\n            });\n          }, 50);\n        },\n        complete: () => {\n          uni.hideLoading();\n        }\n      });\n    },\n\n    /**\n     * @name 校验发起信息\n     */\n    checkSubmitInfosFun() {\n      if (this.templateData.name.length == 0) {\n        setTimeout(() => {\n          uni.showToast({\n            icon: 'none',\n            title: '请输入合同主题'\n          });\n        }, 50);\n        return false;\n      }\n\n      if (this.templateData.templateSigns.filter(item => item.relationType == 2).some(item => !item.companyName)) {\n        setTimeout(() => {\n          uni.showToast({\n            icon: 'none',\n            title: '签署方企业名称不能为空'\n          });\n        }, 50);\n        return false;\n      }\n\n      if (this.templateData.templateSigns.some(item => !item.userName)) {\n        setTimeout(() => {\n          uni.showToast({\n            icon: 'none',\n            title: '签署方经办人姓名不能为空'\n          });\n        }, 50);\n        return false;\n      }\n\n      if (this.templateData.templateSigns.some(item => !item.userPhone)) {\n        setTimeout(() => {\n          uni.showToast({\n            icon: 'none',\n            title: '签署方经办人手机号不能为空'\n          });\n        }, 50);\n        return false;\n      }\n\n      const result1 = this.checkSignRepeatFun();\n\n      if (!result1.flag) {\n        setTimeout(() => {\n          uni.showToast({\n            icon: 'none',\n            title: result1.msg\n          });\n        }, 50);\n        return false;\n      } // 抄送方校验\n\n\n      if (this.templateData.templateCcs && this.templateData.templateCcs.length > 0) {\n        const result2 = this.checkCcRepeatFun();\n\n        if (!result2.flag) {\n          setTimeout(() => {\n            uni.showToast({\n              icon: 'none',\n              title: result2.msg\n            });\n          }, 50);\n          return false;\n        }\n      }\n\n      return true;\n    },\n\n    /**\n     * @name 检测签署人是否重复\n     */\n    checkSignRepeatFun() {\n      let flag = true;\n      let msg = \"\";\n      let ar1 = [],\n          ar2 = [],\n          ar3 = [],\n          ar4 = [];\n      this.templateData.templateSigns.forEach(it => {\n        if (it.relationType == 1 && it.templateUserType == 3) {\n          ar1.push(it);\n          ar3.push(it.userPhone);\n        }\n\n        if (it.relationType == 2 && it.templateUserType == 3) {\n          ar2.push(it);\n          ar4.push(it.userPhone);\n        }\n      });\n      var repeat1 = ar1.filter(function (item, index) {\n        return ar3.indexOf(item.userPhone) !== index;\n      });\n      var repeat2 = ar2.filter(function (item, index) {\n        return ar4.indexOf(item.userPhone) !== index;\n      });\n\n      if (repeat1.length > 0) {\n        flag = false;\n        msg = '存在重复参与人，请删除重复用户' + repeat1[0].itemName + '后再尝试发起';\n      }\n\n      if (repeat2.length > 0) {\n        flag = false;\n        msg = '存在重复参与人，请删除重复用户' + repeat2[0].itemName + '后再尝试发起';\n      }\n\n      return {\n        flag,\n        msg\n      };\n    },\n\n    /**\n     * @name 检测抄送人是否重复\n     */\n    checkCcRepeatFun() {\n      let flag = true;\n      let msg = \"\";\n      let ar1 = [],\n          ar2 = [],\n          ar3 = [],\n          ar4 = [];\n      this.templateData.templateCcs.forEach(it => {\n        if (it.relationType == 1) {\n          ar1.push(it);\n          ar3.push(it.userPhone);\n        }\n\n        if (it.relationType == 2) {\n          ar2.push(it);\n          ar4.push(it.userPhone);\n        }\n      });\n      var repeat1 = ar1.filter(function (item, index) {\n        return ar3.indexOf(item.userPhone) !== index;\n      });\n      var repeat2 = ar2.filter(function (item, index) {\n        return ar4.indexOf(item.userPhone) !== index;\n      });\n      console.log(repeat1[0], repeat2[0]);\n\n      if (repeat1.length > 0) {\n        flag = false;\n        msg = '存在重复抄送人，请删除重复用户' + (repeat1[0].relationType == 1 ? repeat1[0].userName : repeat1[0].companyName) + '后再尝试发起';\n      }\n\n      if (repeat2.length > 0) {\n        flag = false;\n        msg = '存在重复抄送人，请删除重复用户' + (repeat2[0].relationType == 1 ? repeat2[0].userName : repeat2[0].companyName) + '后再尝试发起';\n      }\n\n      return {\n        flag,\n        msg\n      };\n    }\n\n  }\n};\r\n</script>\r\n<style>\r\n@import \"./index.css\";\r\n</style>","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1608793120895\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}