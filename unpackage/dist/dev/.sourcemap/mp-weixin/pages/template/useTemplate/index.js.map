{"version":3,"sources":["uni-app:///main.js","webpack:////Users/icourt/Desktop/mycode/uni/pages/template/useTemplate/index.vue?4195","webpack:////Users/icourt/Desktop/mycode/uni/pages/template/useTemplate/index.vue?1577","webpack:////Users/icourt/Desktop/mycode/uni/pages/template/useTemplate/index.vue?ae5c","webpack:////Users/icourt/Desktop/mycode/uni/pages/template/useTemplate/index.vue?2ece","uni-app:///pages/template/useTemplate/index.vue","webpack:////Users/icourt/Desktop/mycode/uni/pages/template/useTemplate/index.vue?10d1","webpack:////Users/icourt/Desktop/mycode/uni/pages/template/useTemplate/index.vue?3d0d"],"names":["createPage","Page"],"mappings":"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","file":"pages/template/useTemplate/index.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/template/useTemplate/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=32242470&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/template/useTemplate/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=32242470&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n<view class=\"use-template--page\">\r\n  <view class=\"title\">合同主题</view>\r\n  <view class=\"input-area\">\r\n    <input type=\"text\" maxlength=\"100\" :value=\"templateData.name\" @input=\"handleChangeContractTitleFun\"></input>\r\n    <text class=\"delete one one-close\" @tap=\"handleClearContractTitleFun\"></text>\r\n  </view>\r\n  <view class=\"title\">合同文件</view>\r\n  <view class=\"file-list\">\r\n    <view v-for=\"(item, index) in fileList\" :key=\"index\" class=\"file-item\" :data-item=\"item\" @tap.stop=\"handlePreviewFileFun\">\r\n      <view class=\"l-wrapper\">\r\n        <view class=\"icon\">\r\n          <image :src=\"fileIcon\" mode=\"aspectFit\"></image>\r\n        </view>\r\n        <view class=\"name\">{{item.fileName}}</view>\r\n      </view>\r\n      <text class=\"one one-apparrow-right arrow\"></text>\r\n    </view>\r\n  </view>\r\n  <view class=\"title\">合同附件</view>\r\n  <view class=\"file-list\">\r\n    <view v-for=\"(item, index) in attachment\" :key=\"index\" class=\"file-item\" :data-item=\"item\" @tap.stop=\"handlePreviewFileFun\">\r\n      <view class=\"l-wrapper\">\r\n        <view class=\"icon\">\r\n          <image :src=\"fileIcon\" mode=\"aspectFit\"></image>\r\n        </view>\r\n        <view class=\"name\">{{item.fileName}}</view>\r\n      </view>\r\n      <text class=\"one one-apparrow-right arrow\"></text>\r\n    </view>\r\n  </view>\r\n  <view class=\"title\">参与方</view>\r\n  <view class=\"sign-list\">\r\n    <view v-for=\"(item, index) in templateData.templateSigns\" :key=\"index\" class=\"sign-item\">\r\n      <view class=\"user-info\">\r\n        <view class=\"info\">\r\n          <view class=\"name-auth\">\r\n            <view class=\"name\">{{item.relationType == 2 ? (item.companyName ? item.companyName : '待填写') : item.relationType == 1 ? (item.userName ? item.userName : '待填写') : '待填写'}}</view>\r\n            <view :class=\"'auth-status ' + ((item.relationType == 2 && item.companyAuthStatus) || (item.relationType == 1 && item.personAuthStatus) ? 'authed' : 'unauth')\">{{(item.relationType == 2 && item.companyAuthStatus) || (item.relationType == 1 && item.personAuthStatus) ? '已认证' : '未认证'}}</view>\r\n          </view>\r\n          <view class=\"phone-auth\">\r\n            <view class=\"phone\"><text v-if=\"item.relationType == 2\">{{item.userName ? item.userName : '待填写'}}</text> {{item.userPhone ? item.userPhone : ''}}</view><view :class=\"'auth-status ' + (item.personAuthStatus ? 'authed' : 'unauth')\" v-if=\"(item.userName && item.relationType == 2)\">{{item.personAuthStatus ? '已认证' : '未认证'}}</view>\r\n          </view>\r\n          <view class=\"seals\">{{item.sealWords}}</view>\r\n        </view>\r\n        <view class=\"edit\" v-if=\"item.templateUserType == 2\" :data-item=\"item\" :data-index=\"index\" @tap=\"handleEditItemFun\">\r\n          <text>编辑</text><text class=\"one one-apparrow-right arrow\"></text>\r\n        </view>\r\n      </view>\r\n      <view class=\"order\">\r\n        <view class=\"sub-title\">参与顺序</view>\r\n        <view class=\"order-detail\">\r\n          <view class=\"fill item\" v-if=\"item.hasFill && item.fillOrder > -1\">\r\n            填写\r\n            <text class=\"order-words\">{{item.fillOrder + 1}}</text>\r\n          </view>\r\n          <view class=\"sign item\" v-if=\"item.hasSign && item.signOrder > -1\">\r\n            签署\r\n            <text class=\"order-words\">{{item.signOrder + 1}}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n  <view class=\"title\">抄送方</view>\r\n  <view class=\"add-cc\">\r\n    <view class=\"add-btn\" @tap=\"handleAddCompanyFun\">\r\n      <image class=\"addSign\" mode=\"aspectFit\" :src=\"addIcon\"></image>\r\n      添加企业\r\n    </view>\r\n    <view class=\"add-btn\" @tap=\"handleAddPersonFun\">\r\n      <image class=\"addSign\" mode=\"aspectFit\" :src=\"addIcon\"></image>\r\n      添加个人\r\n    </view>\r\n  </view>\r\n  <view class=\"cc-list\">\r\n    <view v-for=\"(item, index) in templateData.templateCcs\" :key=\"index\" class=\"cc-item\">\r\n      <view class=\"name-auth\">\r\n        <view class=\"name\">{{item.relationType == 2 ? item.companyName : item.userName}}</view>\r\n        <!-- <view class=\"auth-status {{(item.relationType == 2 && item.companyAuthStatus) || (item.relationType == 1 && item.personAuthStatus) ? 'authed' : 'unauth'}}\">{{(item.relationType == 2 && item.companyAuthStatus) || (item.relationType == 1 && item.personAuthStatus) ? '已认证' : '未认证'}}</view> -->\r\n      </view>\r\n      <view class=\"phone\"><text v-if=\"item.relationType == 2\">{{item.userName}}</text> {{item.userPhone}}</view>\r\n      <text class=\"delete one one-close\" v-if=\"item.isNew\" :data-index=\"index\" @tap=\"handleDeleteCcsFun\"></text>\r\n    </view>\r\n  </view>\r\n  <view class=\"title\">其他设置</view>\r\n  <view class=\"other-setting\">\r\n    <view class=\"setting-item\">\r\n      <text class=\"sub-title\">签署截止时间</text>\r\n      <view class=\"date-picker\">\r\n        <picker mode=\"date\" :value=\"date\" start=\"2019-10-01\" end data-type=\"file\" @change=\"handleSelectDateFun\">\r\n          <view class=\"pickDate\">\r\n            <input type=\"date\" disabled=\"true\" name=\"addtime\" :value=\"signEndTime\" placeholder=\"请选择\"></input>\r\n          </view>\r\n        </picker>\r\n        <text class=\"one one-apparrow-right\"></text>\r\n      </view>\r\n    </view>\r\n    <view class=\"setting-item\">\r\n      <text class=\"sub-title\">合同终止时间</text>\r\n      <view class=\"date-picker\">\r\n        <picker mode=\"date\" :value=\"date\" start=\"2019-10-01\" end data-type=\"file\" @change=\"handleSelectDateFun\">\r\n          <view class=\"pickDate\">\r\n            <input type=\"date\" disabled=\"true\" name=\"addtime\" :value=\"fileEndTime\" placeholder=\"请选择\"></input>\r\n          </view>\r\n        </picker>\r\n        <text class=\"one one-apparrow-right\"></text>\r\n      </view>\r\n    </view>\r\n  </view>\r\n  <view class=\"launch-btn\" @tap=\"handleLaunchConfirmFun\">发起签署</view>\r\n</view>\r\n</template>\r\n\r\n<script>\r\nimport { get, postBody } from '../../../api/request.js'\nimport { get_template_detail, confirm_contract_launch_by_template } from '../../../api/template.js'\r\nconst util = require(\"../../../utils/utils\");\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      addIcon: 'https://shouyiner-prod.oss-cn-beijing.aliyuncs.com/wxapp/shanqian/contract/addsign.png',\r\n      fileIcon: \"/static/images/template/file_icon.png\",\r\n      templateData: null,\r\n      fileList: [{\r\n        name: '12312321'\r\n      }],\r\n      // 文件列表\r\n      attachment: [],\r\n      // 附件列表\r\n      signEndTime: '',\r\n      fileEndTime: '',\r\n      id: '',\r\n      // 模版id\r\n      origin: '',\r\n      //来源\r\n      operate: '' // 当前操作类\r\n      ,\r\n      index: \"\"\r\n    };\r\n  },\r\n\r\n  components: {},\r\n  props: {},\r\n\r\n  /**\r\n   * 生命周期函数--监听页面加载\r\n   */\r\n  onLoad: function (options) {\r\n    const id = options.id;\r\n    let arr = [];\r\n    this.setData({\r\n      id: id,\r\n      origin: options.origin || '',\r\n      operate: options.operate || '',\r\n      index: options.index || -1\r\n    });\r\n\r\n    if (options.origin == 'person') {\r\n      arr.push({\r\n        userName: options.name,\r\n        userPhone: options.phone,\r\n        isNew: true,\r\n        relationType: 1,\r\n        personAuthStatus: options.personAuthStatus || -1\r\n      });\r\n    }\r\n\r\n    if (options.origin == 'company') {\r\n      arr.push({\r\n        companyName: options.companyName,\r\n        userName: options.name,\r\n        userPhone: options.phone,\r\n        isNew: true,\r\n        relationType: 2,\r\n        personAuthStatus: options.personAuthStatus || -1,\r\n        companyAuthStatus: options.companyAuthStatus || -1\r\n      });\r\n    }\r\n\r\n    this.getTemplateDetailFun(arr);\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady: function () {},\r\n\r\n  /**\r\n   * 生命周期函数--监听页面显示\r\n   */\r\n  onShow: function () {},\r\n\r\n  /**\r\n   * 生命周期函数--监听页面隐藏\r\n   */\r\n  onHide: function () {},\r\n\r\n  /**\r\n   * 生命周期函数--监听页面卸载\r\n   */\r\n  onUnload: function () {},\r\n\r\n  /**\r\n   * 页面相关事件处理函数--监听用户下拉动作\r\n   */\r\n  onPullDownRefresh: function () {},\r\n\r\n  /**\r\n   * 页面上拉触底事件的处理函数\r\n   */\r\n  onReachBottom: function () {},\r\n\r\n  /**\r\n   * 用户点击右上角分享\r\n   */\r\n  onShareAppMessage: function () {},\r\n  methods: {\r\n    /**\r\n     * @name 获取模版详情\r\n     */\r\n    getTemplateDetailFun(newArr) {\r\n      uni.showLoading({\r\n        title: '加载中'\r\n      });\r\n      get({\r\n        url: get_template_detail + '?contractTemplateId=' + this.id,\r\n        success: res => {\r\n          console.log(res);\r\n          res.templateSigns.forEach(it => {\r\n            // 处理印章类型展示 - 转化为文字 - 汉字\r\n            it.sealWords = this.conversionSealsFun(it.sealTypes);\r\n\r\n            if (it.templateUserType == 1) {\r\n              const currentUser = uni.getStorageSync('currentUser');\r\n              const userName = uni.getStorageSync('userName');\r\n              const userPhone = uni.getStorageSync('userAccount');\r\n              it.companyName = currentUser.companyName;\r\n              it.userName = userName;\r\n              it.userPhone = userPhone;\r\n            }\r\n          }); // 拿到缓存的所有抄送方\r\n\r\n          if (this.origin) {\r\n            let ccs = uni.getStorageSync('templateCcs');\r\n            let signs = uni.getStorageSync('templateSigns'); // 新增抄送方\r\n\r\n            this.operate == 'add' && ccs.push(newArr[0]);\r\n            res.templateCcs = ccs; // 编辑参与方\r\n\r\n            if (this.operate == 'edit') {\r\n              signs[this.index].userName = newArr[0].userName;\r\n              signs[this.index].userPhone = newArr[0].userPhone;\r\n              signs[this.index].personAuthStatus = newArr[0].personAuthStatus;\r\n\r\n              if (this.origin == 'company') {\r\n                signs[this.index].companyName = newArr[0].companyName;\r\n                signs[this.index].companyAuthStatus = newArr[0].companyAuthStatus;\r\n              }\r\n            }\r\n\r\n            res.templateSigns = signs;\r\n          }\r\n\r\n          uni.setStorageSync('templateCcs', res.templateCcs);\r\n          uni.setStorageSync('templateSigns', res.templateSigns);\r\n          this.setData({\r\n            templateData: res,\r\n            fileList: res.contractTemplateFiles.filter(it => it.attachment == 0),\r\n            attachment: res.contractTemplateFiles.filter(it => it.attachment == 1)\r\n          });\r\n        },\r\n        fail: err => {\r\n          setTimeout(() => {\r\n            uni.showToast({\r\n              icon: 'none',\r\n              title: err\r\n            });\r\n          }, 50);\r\n        },\r\n        complete: () => {\r\n          uni.hideLoading();\r\n        }\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 修改合同主题\r\n     */\r\n    handleChangeContractTitleFun(e) {\r\n      let templateData = this.templateData;\r\n      templateData.name = e.detail.value;\r\n      this.setData({\r\n        templateData: templateData\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 清空合同主题\r\n     */\r\n    handleClearContractTitleFun() {\r\n      let templateData = this.templateData;\r\n      templateData.name = '';\r\n      this.setData({\r\n        templateData: templateData\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 选择日期\r\n     */\r\n    handleSelectDateFun(e) {\r\n      const type = e.currentTarget.dataset.type;\r\n\r\n      switch (type) {\r\n        case 'file':\r\n          this.setData({\r\n            fileEndTime: e.detail.value\r\n          });\r\n          break;\r\n\r\n        case 'sign':\r\n          this.setData({\r\n            signEndTime: e.detail.value\r\n          });\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @name 转化印章类型为文字\r\n     */\r\n    conversionSealsFun(arr) {\r\n      let str = '';\r\n      arr.forEach(it => {\r\n        switch (it) {\r\n          case '1':\r\n            str += '手绘章,';\r\n            break;\r\n\r\n          case '2':\r\n            str += '企业章,';\r\n            break;\r\n\r\n          case '3':\r\n            str += '法人代表章,';\r\n            break;\r\n\r\n          case '4':\r\n            str += '模版章,';\r\n            break;\r\n\r\n          default:\r\n            break;\r\n        }\r\n      });\r\n      str = str.slice(0, str.length - 1);\r\n      return str;\r\n    },\r\n\r\n    /**\r\n     * @name 删除抄送房\r\n     */\r\n    handleDeleteCcsFun(e) {\r\n      let templateData = this.templateData;\r\n      templateData.templateCcs.splice(e.currentTarget.dataset.index, 1);\r\n      this.setData({\r\n        templateData: templateData\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 抄送增加企业\r\n     */\r\n    handleAddCompanyFun() {\r\n      uni.navigateTo({\r\n        url: '/pages/template/addCompany/index?id=' + this.id\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 抄送增加个人\r\n     */\r\n    handleAddPersonFun() {\r\n      uni.navigateTo({\r\n        url: '/pages/template/addPerson/index?id=' + this.id\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 编辑参与方\r\n     */\r\n    handleEditItemFun(e) {\r\n      const item = e.currentTarget.dataset.item;\r\n      const index = e.currentTarget.dataset.index;\r\n      let url = '/pages/template';\r\n\r\n      if (item.relationType == 1) {\r\n        url += '/addPerson/index?index=' + index + '&id=' + this.id + '&name=' + (item.userName ? item.userName : '') + '&phone=' + (item.userPhone ? item.userPhone : '');\r\n      }\r\n\r\n      if (item.relationType == 2) {\r\n        url += '/addCompany/index?index=' + index + '&id=' + this.id + '&name=' + (item.userName ? item.userName : '') + '&phone=' + (item.userPhone ? item.userPhone : '') + '&companyName=' + (item.companyName ? item.companyName : '');\r\n      }\r\n\r\n      uni.navigateTo({\r\n        url: url\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 预览文件\r\n     */\r\n    handlePreviewFileFun(e) {\r\n      const item = e.currentTarget.dataset.item;\r\n      uni.navigateTo({\r\n        url: '/pages/template/preview/index?templateId=' + this.id + '&id=' + item.id\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 发起合同签署\r\n     */\r\n    handleLaunchConfirmFun() {\r\n      if (!this.checkSubmitInfosFun()) return;\r\n      let signs = [],\r\n          fills = [];\r\n      this.templateData.templateSigns.forEach(it => {\r\n        if (it.hasSign) {\r\n          let newSign = JSON.parse(JSON.stringify(it));\r\n          newSign.id = it.signId;\r\n          signs.push(newSign);\r\n        }\r\n\r\n        if (it.hasFill) {\r\n          let newFill = JSON.parse(JSON.stringify(it));\r\n          newFill.id = it.fillId;\r\n          fills.push(newFill);\r\n        }\r\n      });\r\n      let saveParams = {\r\n        createTime: this.templateData.createTime,\r\n        fileTermination: this.fileEndTime,\r\n        id: this.templateData.id,\r\n        modifyTime: this.templateData.modifyTime,\r\n        relationId: this.templateData.relationId,\r\n        relationType: this.templateData.relationType,\r\n        signingDeadline: this.signEndTime,\r\n        status: this.templateData.status,\r\n        name: this.templateData.name,\r\n        userOrder: this.templateData.userOrder,\r\n        contractTemplateFiles: this.templateData.contractTemplateFiles,\r\n        templateCcs: this.templateData.templateCcs,\r\n        templateFillers: fills,\r\n        templateSigners: signs,\r\n        contractSigners: signs\r\n      };\r\n      uni.showLoading({\r\n        title: '发起中'\r\n      });\r\n      postBody({\r\n        url: confirm_contract_launch_by_template,\r\n        params: saveParams,\r\n        success: res => {\r\n          setTimeout(() => {\r\n            uni.showToast({\r\n              icon: 'none',\r\n              title: '合同发起成功'\r\n            });\r\n          }, 50);\r\n          let url = '';\r\n\r\n          if (fills.length > 0) {\r\n            url = '/pages/contract/fill/fill?contractId=' + res;\r\n          } else {\r\n            url = '/pages/contract/sign/next/signConfirm/signConfirm?contractId=' + res;\r\n          }\r\n\r\n          setTimeout(() => {\r\n            uni.redirectTo({\r\n              url: url\r\n            });\r\n          }, 1500);\r\n        },\r\n        fail: err => {\r\n          setTimeout(() => {\r\n            uni.showToast({\r\n              icon: 'none',\r\n              title: err\r\n            });\r\n          }, 50);\r\n        },\r\n        complete: () => {\r\n          uni.hideLoading();\r\n        }\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @name 校验发起信息\r\n     */\r\n    checkSubmitInfosFun() {\r\n      if (this.templateData.name.length == 0) {\r\n        setTimeout(() => {\r\n          uni.showToast({\r\n            icon: 'none',\r\n            title: '请输入合同主题'\r\n          });\r\n        }, 50);\r\n        return false;\r\n      }\r\n\r\n      if (this.templateData.templateSigns.filter(item => item.relationType == 2).some(item => !item.companyName)) {\r\n        setTimeout(() => {\r\n          uni.showToast({\r\n            icon: 'none',\r\n            title: '签署方企业名称不能为空'\r\n          });\r\n        }, 50);\r\n        return false;\r\n      }\r\n\r\n      if (this.templateData.templateSigns.some(item => !item.userName)) {\r\n        setTimeout(() => {\r\n          uni.showToast({\r\n            icon: 'none',\r\n            title: '签署方经办人姓名不能为空'\r\n          });\r\n        }, 50);\r\n        return false;\r\n      }\r\n\r\n      if (this.templateData.templateSigns.some(item => !item.userPhone)) {\r\n        setTimeout(() => {\r\n          uni.showToast({\r\n            icon: 'none',\r\n            title: '签署方经办人手机号不能为空'\r\n          });\r\n        }, 50);\r\n        return false;\r\n      }\r\n\r\n      const result1 = this.checkSignRepeatFun();\r\n\r\n      if (!result1.flag) {\r\n        setTimeout(() => {\r\n          uni.showToast({\r\n            icon: 'none',\r\n            title: result1.msg\r\n          });\r\n        }, 50);\r\n        return false;\r\n      } // 抄送方校验\r\n\r\n\r\n      if (this.templateData.templateCcs && this.templateData.templateCcs.length > 0) {\r\n        const result2 = this.checkCcRepeatFun();\r\n\r\n        if (!result2.flag) {\r\n          setTimeout(() => {\r\n            uni.showToast({\r\n              icon: 'none',\r\n              title: result2.msg\r\n            });\r\n          }, 50);\r\n          return false;\r\n        }\r\n      }\r\n\r\n      return true;\r\n    },\r\n\r\n    /**\r\n     * @name 检测签署人是否重复\r\n     */\r\n    checkSignRepeatFun() {\r\n      let flag = true;\r\n      let msg = \"\";\r\n      let ar1 = [],\r\n          ar2 = [],\r\n          ar3 = [],\r\n          ar4 = [];\r\n      this.templateData.templateSigns.forEach(it => {\r\n        if (it.relationType == 1 && it.templateUserType == 3) {\r\n          ar1.push(it);\r\n          ar3.push(it.userPhone);\r\n        }\r\n\r\n        if (it.relationType == 2 && it.templateUserType == 3) {\r\n          ar2.push(it);\r\n          ar4.push(it.userPhone);\r\n        }\r\n      });\r\n      var repeat1 = ar1.filter(function (item, index) {\r\n        return ar3.indexOf(item.userPhone) !== index;\r\n      });\r\n      var repeat2 = ar2.filter(function (item, index) {\r\n        return ar4.indexOf(item.userPhone) !== index;\r\n      });\r\n\r\n      if (repeat1.length > 0) {\r\n        flag = false;\r\n        msg = '存在重复参与人，请删除重复用户' + repeat1[0].itemName + '后再尝试发起';\r\n      }\r\n\r\n      if (repeat2.length > 0) {\r\n        flag = false;\r\n        msg = '存在重复参与人，请删除重复用户' + repeat2[0].itemName + '后再尝试发起';\r\n      }\r\n\r\n      return {\r\n        flag,\r\n        msg\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @name 检测抄送人是否重复\r\n     */\r\n    checkCcRepeatFun() {\r\n      let flag = true;\r\n      let msg = \"\";\r\n      let ar1 = [],\r\n          ar2 = [],\r\n          ar3 = [],\r\n          ar4 = [];\r\n      this.templateData.templateCcs.forEach(it => {\r\n        if (it.relationType == 1) {\r\n          ar1.push(it);\r\n          ar3.push(it.userPhone);\r\n        }\r\n\r\n        if (it.relationType == 2) {\r\n          ar2.push(it);\r\n          ar4.push(it.userPhone);\r\n        }\r\n      });\r\n      var repeat1 = ar1.filter(function (item, index) {\r\n        return ar3.indexOf(item.userPhone) !== index;\r\n      });\r\n      var repeat2 = ar2.filter(function (item, index) {\r\n        return ar4.indexOf(item.userPhone) !== index;\r\n      });\r\n      console.log(repeat1[0], repeat2[0]);\r\n\r\n      if (repeat1.length > 0) {\r\n        flag = false;\r\n        msg = '存在重复抄送人，请删除重复用户' + (repeat1[0].relationType == 1 ? repeat1[0].userName : repeat1[0].companyName) + '后再尝试发起';\r\n      }\r\n\r\n      if (repeat2.length > 0) {\r\n        flag = false;\r\n        msg = '存在重复抄送人，请删除重复用户' + (repeat2[0].relationType == 1 ? repeat2[0].userName : repeat2[0].companyName) + '后再尝试发起';\r\n      }\r\n\r\n      return {\r\n        flag,\r\n        msg\r\n      };\r\n    }\r\n\r\n  }\r\n};\r\n</script>\r\n<style>\r\n@import \"./index.css\";\r\n</style>","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1608810047088\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}