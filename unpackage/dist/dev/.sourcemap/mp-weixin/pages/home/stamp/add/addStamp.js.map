{"version":3,"sources":["uni-app:///main.js","webpack:////Users/icourt/Desktop/code/wxApp/pages/home/stamp/add/addStamp.vue?b8bf","webpack:////Users/icourt/Desktop/code/wxApp/pages/home/stamp/add/addStamp.vue?db22","webpack:////Users/icourt/Desktop/code/wxApp/pages/home/stamp/add/addStamp.vue?cd33","webpack:////Users/icourt/Desktop/code/wxApp/pages/home/stamp/add/addStamp.vue?900e","uni-app:///pages/home/stamp/add/addStamp.vue","webpack:////Users/icourt/Desktop/code/wxApp/pages/home/stamp/add/addStamp.vue?1878","webpack:////Users/icourt/Desktop/code/wxApp/pages/home/stamp/add/addStamp.vue?149b"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,2G;AACAA,UAAU,CAACC,iBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqH;AACrH;AAC4D;AACL;AACa;;;AAGpE;AACsN;AACtN,gBAAgB,iNAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mFAAM;AACR,EAAE,4FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAo2B,CAAgB,syBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACiCx3B;AACA;AACA,mB;;AAEA;AACA,MADA,kBACA;AACA;AACA,kBADA;AAEA,mBAFA;AAGA,cAHA;AAIA,wBAJA;;AAMA,GARA;;AAUA,gBAVA;AAWA,WAXA;AAYA;AACA;AACA;AACA,oBADA;AAEA,uBAFA;;AAIA,KALA,EAKA,EALA;AAMA,GAnBA;;AAqBA;;;AAGA,qCAxBA;;AA0BA,mBA1BA,+BA0BA,EA1BA;;AA4BA;AACA;AACA;AACA,KAHA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAPA,CAOA;;AAEA;AACA,KAfA;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BARA,CAQA;AACA;AACA;AACA;AACA;AACA;AACA,KA/BA;AAgCA;AACA;AACA;AACA;AACA,gBADA;;AAGA,KAtCA;;AAwCA,iBAxCA,2BAwCA;AACA;AACA,sCADA;;AAGA,KA5CA;;AA8CA;AACA;AACA;AACA;AACA,oBADA;;AAGA,KApDA;AAqDA;AACA;AACA;AACA;AACA,KAzDA;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA,iCADA;AAEA;AACA,cAHA;AAIA,cAJA;AAKA,sBALA;AAMA,wBANA;;AAQA,iBARA,mBAQA,GARA,EAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCADA;AAEA,oBAFA;AAGA,oBAHA;AAIA,6BAJA;AAKA,6BALA;AAMA;AACA;AACA,6BADA;AAEA,8BAFA;;AAIA;AACA,kDADA;AAEA,8CAFA;AAGA,+BAHA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CADA;AAEA,0DAFA;;AAIA;AACA,oDADA;AAEA,sCAFA;AAGA;AACA,sCADA;AAEA,yCAFA;AAGA,yCAHA,EAHA;;AAQA;AACA,yCADA,CACA;AACA;AACA;;AAEA;AACA;AACA,6DADA;;AAGA,yBAjBA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DADA;;AAGA,yBA3BA;;AA6BA,qBA3CA;AA4CA;AACA;AACA;AACA,qBA/CA;;AAiDA,iBA5DA;;AA8DA,aA/DA;AAgEA,WAnFA;;AAqFA,cArFA,gBAqFA,CArFA,EAqFA;AACA;AACA,WAvFA;;;AA0FA,OA7FA,EA6FA,IA7FA;AA8FA,KA1JA,EA5BA,E;;;;;;;;;;;;;ACrCA;AAAA;AAAA;AAAA;AAA6tC,CAAgB,mmCAAG,EAAC,C;;;;;;;;;;;ACAjvC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/home/stamp/add/addStamp.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/home/stamp/add/addStamp.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./addStamp.vue?vue&type=template&id=bb7e123a&\"\nvar renderjs\nimport script from \"./addStamp.vue?vue&type=script&lang=js&\"\nexport * from \"./addStamp.vue?vue&type=script&lang=js&\"\nimport style0 from \"./addStamp.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/home/stamp/add/addStamp.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addStamp.vue?vue&type=template&id=bb7e123a&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addStamp.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addStamp.vue?vue&type=script&lang=js&\"","<template>\r\n<view>\r\n<!--pages/home/stamp/add/addStamp.wxml-->\n<canvas canvas-id=\"stampCanvas\" id=\"stampCanvas\" class=\"stamp-canvas\" disable-scroll=\"false\" @touchstart=\"touchStart\" @touchmove=\"touchMove\"> \n    <image class=\"watermark\" src=\"/static/pages/home/stamp/add/watermark.png\">在此签名</image>    \n</canvas>\n<canvas class=\"stamp-canvas copy-canvas\" canvas-id=\"myCanvas\" id=\"myCanvas\" style=\"z-index: -11; opacity: 0; visiblity: hidden;\"></canvas>\n<view class=\"operation-btn-view\">\n    <view :class=\"'first-pen-btn pen-btn ' + (color==='#000'?'active':'') + '}'\" data-color=\"#000\" @tap.stop=\"switchColor\">\n        <view class=\"one one-dot\" style=\"background-color:#000\"></view>\n    </view>\n    <view :class=\"'pen-btn ' + (color==='#22ACF8'?'active':'')\" data-color=\"#22ACF8\" @tap.stop=\"switchColor\">\n        <view class=\"one one-dot\" style=\"background-color:#22ACF8\"></view>\n    </view>\n    <view :class=\"'pen-btn ' + (color==='#FE4E51'?'active':'')\" data-color=\"#FE4E51\" @tap.stop=\"switchColor\">\n        <view class=\"one one-dot\" style=\"background-color:#FE4E51\"></view>\n    </view>\n    <view class=\"line\"></view>\n    <image src=\"/static/pages/home/stamp/add/pen.png\" :class=\"'pen-btn pen-size ' + (pen=='4'?'active-pen':'')\" @tap.stop=\"switchPenSize\" data-pen=\"4\"></image>\n    <image src=\"/static/pages/home/stamp/add/pen1.png\" :class=\"'pen-btn pen-size ' + (pen=='6'?'active-pen':'')\" @tap.stop=\"switchPenSize\" data-pen=\"6\"></image>\n    <image src=\"/static/pages/home/stamp/add/pen2.png\" :class=\"'pen-btn pen-size ' + (pen=='8'?'active-pen':'')\" @tap.stop=\"switchPenSize\" data-pen=\"8\"></image>\n    <view class=\"clean-btn\" @tap.stop=\"clearAction\">\n        <text class=\"clean-text\">清除</text>\n    </view>\n    <view class=\"submit-btn\" @tap.stop=\"submitAction\">\n        <text class=\"submit-text\">提交</text>\n    </view>\n\n</view>\r\n</view>\r\n</template>\r\n\r\n<script>\r\n// pages/home/stamp/add/addStamp.js\nvar api = require(\"../../../../api/request.js\");\r\nconst app = getApp();\r\n\r\nexport default {\n  data() {\n    return {\n      stampUrl: '',\n      color: '#000',\n      pen: '4',\n      penSizeShow: false\n    };\n  },\n\n  components: {},\n  props: {},\n  onShow: function () {\n    setTimeout(() => {\n      uni.showToast({\n        icon: 'none',\n        title: '请将手机横屏'\n      });\n    }, 50);\n  },\n\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad: function (options) {},\n\n  onShareAppMessage() {},\n\n  methods: {\n    canvasIdErrorCallback: function (e) {\n      console.error('canvas error:' + e.detail.errMsg);\n    },\n    //手指触摸动作开始\n    touchStart: function (e) {\n      //得到触摸点的坐标\n      this.startX = e.changedTouches[0].x;\n      this.startY = e.changedTouches[0].y;\n      this.context = uni.createCanvasContext('stampCanvas');\n      this.context.setStrokeStyle(this.color);\n      this.context.setLineWidth(this.pen);\n      this.context.setLineCap('round'); // 让线条圆润\n\n      this.context.beginPath();\n    },\n    //手指触摸后移动\n    touchMove: function (e) {\n      var startX1 = e.changedTouches[0].x;\n      var startY1 = e.changedTouches[0].y;\n      this.context.moveTo(this.startX, this.startY);\n      this.context.lineTo(startX1, startY1);\n      this.context.stroke();\n      this.startX = startX1;\n      this.startY = startY1;\n      this.context.draw(true); //只是一个记录方法调用的容器，用于生成记录绘制行为的actions数组。context跟<canvas/>不存在对应关系，一个context生成画布的绘制动作数组可以应用于多个<canvas/>\n      // wx.drawCanvas({\n      //   canvasId: 'stampCanvas',\n      //   reserve: true,\n      //   actions: this.context.getActions() // 获取绘图动作数组\n      // })\n    },\n    switchPen: function (e) {\n      console.log('切换font');\n      var pen = e.currentTarget.dataset.pen;\n      this.setData({\n        pen: pen\n      });\n    },\n\n    switchPenSize() {\n      this.setData({\n        penSizeShow: !this.penSizeShow\n      });\n    },\n\n    switchColor: function (e) {\n      console.log('切换color');\n      var color = e.currentTarget.dataset.color;\n      this.setData({\n        color: color\n      });\n    },\n    clearAction: function () {\n      console.log('清除');\n      this.context.clearRect(0, 0, 750, 1334);\n      this.context.draw();\n    },\n    submitAction: function () {\n      const query = uni.createSelectorQuery();\n      query.select('#stampCanvas').boundingClientRect(rect => {\n        const width = rect.width;\n        const height = rect.height;\n        uni.canvasToTempFilePath({\n          canvasId: 'stampCanvas',\n          // fileType:'jpg',\n          x: 0,\n          y: 0,\n          width: width,\n          height: height,\n\n          success(res) {\n            var tempFilePath = res.tempFilePath;\n            console.log(tempFilePath);\n            const ctx = uni.createCanvasContext('myCanvas');\n            ctx.fillStyle = '#fff';\n            ctx.fillRect(0, 0, width, height);\n            const ratio = width / height;\n            ctx.rotate(-90 * Math.PI / 180);\n            ctx.scale(ratio, ratio);\n            ctx.translate(-width * 1.5, 0);\n            ctx.drawImage(tempFilePath, 0, 0, width, height);\n            ctx.draw(true, () => {\n              uni.canvasToTempFilePath({\n                canvasId: 'myCanvas',\n                x: 0,\n                y: 0,\n                width: height,\n                height: width,\n                success: res => {\n                  uni.showLoading({\n                    title: '',\n                    mask: true\n                  });\n                  api.uploadFile({\n                    url: api.upload_painted_wx_url,\n                    filePath: res.tempFilePath,\n                    key: 'file',\n                    // formData: {\n                    //   \"\":sfg,\n                    // },\n                    success: function (data) {\n                      console.log(data);\n                      var userToken = app.globalData.getUserToken();\n                      var header = {\n                        \"token\": userToken,\n                        \"Content-Type\": \"application/json\"\n                      };\n                      api.sendPostBody({\n                        url: api.save_personnal_seal,\n                        header: header,\n                        params: {\n                          \"name\": \"印章\",\n                          \"url\": data.url,\n                          \"originType\": 1\n                        },\n                        success: function (e) {\n                          console.log(e); // var dataArray = _this.data.stampArray;\n                          // dataArray.splice(index, 1);\n                          // _this.updateData(dataArray);\n\n                          uni.hideLoading();\n                          uni.navigateBack({\n                            delta: getCurrentPages.length - 1\n                          });\n                        },\n                        fail: function (err) {\n                          // wx.showToast({\n                          //   icon: 'none',\n                          //   title: err\n                          // })\n                          uni.hideLoading();\n                          uni.navigateBack({\n                            delta: getCurrentPages.length - 1\n                          });\n                        }\n                      });\n                    },\n                    fail: function (msg) {\n                      console.log(msg);\n                      uni.hideLoading();\n                    }\n                  });\n                }\n              });\n            });\n          },\n\n          fail(e) {\n            console.log(e);\n          }\n\n        });\n      }).exec();\n    }\n  }\n};\r\n</script>\r\n<style>\r\n@import \"./addStamp.css\";\r\n</style>","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addStamp.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addStamp.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1608793121175\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}